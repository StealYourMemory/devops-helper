import{a as S}from"./axios-CEz4Hwn_.js";import{t as b}from"./time-DxmJvrj7.js";import{d as D}from"./debounce-BzScJiEs.js";import{d as N,j as V,s as P,x as A,E,o as w,g as h,w as o,r as n,f as e,z as F,n as g,t as _,m as x,_ as M}from"./index-B8KVQuq1.js";const j="/operation-log";async function q(f){return(await S.post(`${j}/log`,f)).data}const G=N({__name:"InspectionLog",setup(f){const a=V({user:"",operation:""}),r=V({paging:!0,page:1,total:0,size:10});P(()=>{i()});const y=D(i,300);A(a,y,{deep:!0});async function i(){const p=await q({...a.value,...r.value});if(p.success){const{paging:t,page:d,size:u,total:c,records:m}=p.data;r.value={paging:t,page:d,size:u,total:c,records:m}}else E.error(p.msg)}return(p,t)=>{const d=n("el-input"),u=n("el-form-item"),c=n("el-option"),m=n("el-select"),v=n("el-date-picker"),z=n("el-space"),T=n("el-form"),U=n("el-header"),s=n("el-table-column"),C=n("el-table"),k=n("el-main"),L=n("el-pagination"),B=n("el-footer"),I=n("el-container");return w(),h(I,null,{default:o(()=>[a.value?(w(),h(U,{key:0},{default:o(()=>[e(T,{modelValue:a.value,"onUpdate:modelValue":t[5]||(t[5]=l=>a.value=l),inline:""},{default:o(()=>[e(u,{label:"用户名"},{default:o(()=>[e(d,{modelValue:a.value.user,"onUpdate:modelValue":t[0]||(t[0]=l=>a.value.user=l),clearable:""},null,8,["modelValue"])]),_:1}),e(u,{label:"操作类型"},{default:o(()=>[e(d,{modelValue:a.value.operation,"onUpdate:modelValue":t[1]||(t[1]=l=>a.value.operation=l),clearable:""},null,8,["modelValue"])]),_:1}),e(u,{label:"是否成功"},{default:o(()=>[e(m,{modelValue:a.value.success,"onUpdate:modelValue":t[2]||(t[2]=l=>a.value.success=l),clearable:"",placeholder:"是否成功"},{default:o(()=>[e(c,{value:!0,label:"是"}),e(c,{value:!1,label:"否"})]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"时间"},{default:o(()=>[e(z,null,{default:o(()=>[e(v,{modelValue:a.value.startTime,"onUpdate:modelValue":t[3]||(t[3]=l=>a.value.startTime=l),type:"datetime",placeholder:"开始","value-format":"x",clearable:""},null,8,["modelValue"]),e(v,{modelValue:a.value.endTime,"onUpdate:modelValue":t[4]||(t[4]=l=>a.value.endTime=l),type:"datetime",placeholder:"结束","value-format":"x",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})):F("",!0),e(k,{style:{"margin-top":"2%"}},{default:o(()=>[e(C,{data:r.value.records,stripe:"","max-height":"500"},{default:o(()=>[e(s,{type:"index",label:"#"}),e(s,{prop:"user",label:"用户",width:"100",align:"center","header-align":"center"}),e(s,{prop:"operation",label:"操作类型",width:"140",align:"center","header-align":"center"}),e(s,{prop:"requestDetail",label:"请求详情",align:"center","header-align":"center","show-overflow-tooltip":{effect:"light",placement:"bottom"},"tooltip-effect":"light"}),e(s,{label:"结果",align:"center","header-align":"center"},{default:o(l=>[g(_(l.row.success==null?"--":l.row.success?"执行成功":"执行失败"),1)]),_:1}),e(s,{prop:"resultDetail",label:"结果详情",align:"center","header-align":"center","show-overflow-tooltip":{effect:"light",placement:"bottom"},"tooltip-effect":"light"}),e(s,{label:"开始时间",align:"center","header-align":"center",width:"200"},{default:o(l=>[g(_(x(b)(l.row.startTime)),1)]),_:1}),e(s,{label:"结束时间",align:"center","header-align":"center",width:"200"},{default:o(l=>[g(_(l.row.endTime==null?"--":x(b)(l.row.endTime)),1)]),_:1})]),_:1},8,["data"])]),_:1}),e(B,{class:"footer-right"},{default:o(()=>[e(L,{"current-page":r.value.page,"onUpdate:currentPage":t[6]||(t[6]=l=>r.value.page=l),"page-size":r.value.size,"onUpdate:pageSize":t[7]||(t[7]=l=>r.value.size=l),"page-sizes":[10,20,50,100],layout:"total,prev, pager, next,sizes",total:r.value.total,onSizeChange:i,onCurrentChange:i},null,8,["current-page","page-size","total"])]),_:1})]),_:1})}}}),O=M(G,[["__scopeId","data-v-e6d3990f"]]);export{O as default};
