import{a as d}from"./axios-CEz4Hwn_.js";import{d as q,P as E,Q as f,j as m,s as O,E as N,r as n,o as r,g,w as a,f as l,c as x,l as L,F as h,m as R,R as A,a as I,O as T}from"./index-B8KVQuq1.js";import{L as j}from"./LoadingIcon-BIsLc0kW.js";const c="/devops";async function D(){return(await d.get(`${c}/sprints-optional`)).data}async function H(e){return(await d.get(`${c}/request-list?sprint=${e}`)).data}async function J(e){return(await d.get(`${c}/bug-list?sprint=${e}`)).data}async function K(e){return(await d.post(`${c}/send-mail`,e)).data}const P=I("span",null,"邮件通知",-1),W=q({__name:"DevopsFilterForm",props:{sprintModel:{required:!0},sprintModelModifiers:{},statusModel:{required:!0},statusModelModifiers:{},userModel:{required:!0},userModelModifiers:{}},emits:E(["sendMail","userFetchSuggestion"],["update:sprintModel","update:statusModel","update:userModel"]),setup(e,{emit:o}){const _=o,B=()=>{_("sendMail")},F=(u,s)=>{_("userFetchSuggestion",u,s)},b=f(e,"sprintModel"),v=f(e,"statusModel"),M=f(e,"userModel"),C=m([{label:"全部",value:"ALL"},{label:"不合格",value:"FAIL"},{label:"合格",value:"SUCCESS"}]),w=m([]),p=m(!1);return O(async()=>{p.value=!0;const u=await D();p.value=!1,u.success?w.value=u.data.map(s=>({label:s.name,value:s.id,disabled:!1})):N.error(u.msg)}),(u,s)=>{const S=n("el-option"),y=n("el-icon"),V=n("el-select"),i=n("el-form-item"),k=n("el-autocomplete"),U=n("el-button"),$=n("el-form");return r(),g($,{inline:""},{default:a(()=>[l(i,{label:"迭代版本"},{default:a(()=>[l(V,{modelValue:b.value,"onUpdate:modelValue":s[0]||(s[0]=t=>b.value=t),filterable:"",placeholder:"请选择迭代版本",loading:p.value,style:{width:"180px"}},{loading:a(()=>[l(y,{class:"is-loading"},{default:a(()=>[l(j)]),_:1})]),default:a(()=>[(r(!0),x(h,null,L(w.value,t=>(r(),g(S,{key:t.label,label:t.label,value:t.value,disabled:t.disabled},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue","loading"])]),_:1}),l(i,{label:"审查结果"},{default:a(()=>[l(V,{modelValue:v.value,"onUpdate:modelValue":s[1]||(s[1]=t=>v.value=t),filterable:"",placeholder:"请选择审查结果",style:{width:"120px"}},{default:a(()=>[(r(!0),x(h,null,L(C.value,t=>(r(),g(S,{key:t.label,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"责任人"},{default:a(()=>[l(k,{modelValue:M.value,"onUpdate:modelValue":s[2]||(s[2]=t=>M.value=t),"fetch-suggestions":F,clearable:""},null,8,["modelValue"])]),_:1}),l(i,{onClick:B},{default:a(()=>[l(U,{type:"warning"},{default:a(()=>[l(y,null,{default:a(()=>[l(R(A))]),_:1}),P]),_:1})]),_:1})]),_:1})}}});function X({row:e}){return e.success?"":"warning-row"}function Y(e,o){T.confirm("确认当前审查没有问题?",{confirmButtonText:"是",cancelButtonText:"取消",type:"warning"}).then(()=>{e.suggest.splice(o,1),(e.suggest==null||e.suggest.length===0)&&(e.success=!0)}).catch(()=>{})}export{W as _,J as a,Y as d,H as g,K as s,X as t};
